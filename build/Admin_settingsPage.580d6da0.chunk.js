(self.webpackChunkapi_cms=self.webpackChunkapi_cms||[]).push([[5895],{10608:(k,R,t)=>{"use strict";t.r(R),t.d(R,{SettingsPage:()=>St,default:()=>Ut});var e=t(67294),f=t(95489),s=t(49656),r=t(28702),c=t(97132),T=t(15482),K=t(48474),Q=t(38683),ue=t(23724),j=t(41363),x=t(87751),ke=t(45697),C=t.n(ke);const le=750,ce=100,Ue=["image/jpeg","image/png","image/svg+xml"];var ee=t(18172);const ze={localImage:void 0},Ee=(y=ze,m)=>(0,ee.default)(y,g=>{switch(m.type){case"SET_LOCAL_IMAGE":{g.localImage=m.value;break}default:return g}}),We=({onChangeLogo:y,customLogo:m,goTo:g,Component:b,modalTitle:p,next:Z,prev:ae,currentStep:G})=>{const[{localImage:$},F]=(0,e.useReducer)(Ee,ze),{formatMessage:fe}=(0,c.useIntl)(),V=Le=>{F({type:"SET_LOCAL_IMAGE",value:Le})},Fe=()=>{g(null)};return G?e.createElement(r.ModalLayout,{labelledBy:"modal",onClose:Fe},e.createElement(r.ModalHeader,null,e.createElement(r.Typography,{fontWeight:"bold",as:"h2",id:"modal"},fe(p))),e.createElement(b,{setLocalImage:V,goTo:g,next:Z,prev:ae,onClose:Fe,asset:$||m,onChangeLogo:y})):null};We.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},We.propTypes={Component:C().elementType,currentStep:C().string,customLogo:C().shape({name:C().string,url:C().string,width:C().number,height:C().number,ext:C().string}),goTo:C().func.isRequired,modalTitle:C().shape({id:C().string,defaultMessage:C().string}),next:C().string,onChangeLogo:C().func.isRequired,prev:C().string};const Ze=We,L={currentStep:void 0},X=(y=L,m)=>(0,ee.default)(y,g=>{switch(m.type){case"GO_TO":{g.currentStep=m.to;break}default:return g}});var w=t(27821);const be={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},J={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},Pe=y=>new Promise(m=>{const g=new FileReader;g.onload=()=>{const b=new Image;b.onload=function(){m({width:b.width,height:b.height})},b.src=g.result},g.readAsDataURL(y)}),D=(y,m)=>({ext:y.name.split(".").pop(),size:y.size/1e3,name:y.name,url:URL.createObjectURL(y),rawFile:y,width:m.width,height:m.height}),N=async y=>{let m;if(!Ue.includes(y.type))throw m=new Error("File format"),m.displayMessage=be,m;const b=await Pe(y);if(!(b.width<=le&&b.height<=le))throw m=new Error("File sizing"),m.displayMessage=J,m;const Z=D(y,b);if(!(Z.size<=ce))throw m=new Error("File sizing"),m.displayMessage=J,m;return Z},q=(0,w.default)(r.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,Y=({setLocalImage:y,goTo:m,next:g,onClose:b})=>{const{formatMessage:p}=(0,c.useIntl)(),[Z,ae]=(0,e.useState)(!1),[G,$]=(0,e.useState)(void 0),F=(0,e.useRef)(null),fe=()=>ae(!0),V=()=>ae(!1),Fe=He=>{He.preventDefault(),F.current.click()},Le=async()=>{V();const He=F.current.files[0];if(He)try{const je=await N(He);y(je),m(g)}catch(je){if(je.displayMessage)$(p(je.displayMessage,{size:ce,dimension:le})),F.current.focus();else throw je}},Ne=()=>Z?"primary500":G?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.Field,{name:"logo-upload",error:G},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(r.Stack,{spacing:2},e.createElement(r.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:Z?"primary100":"neutral100",borderColor:Ne(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:fe,onDragLeave:V},e.createElement(r.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:j.PicturePlus,"aria-hidden":!0}),e.createElement(r.Box,{paddingTop:3,paddingBottom:5},e.createElement(r.Typography,{variant:"delta",as:"span"},p({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(q,{accept:Ue,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Le,ref:F,id:"logo-upload"}),e.createElement(r.Button,{type:"button",onClick:Fe},p({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(r.Box,{paddingTop:6},e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},p({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:ce,dimension:le})))),e.createElement(r.FieldError,null)))))),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:b,variant:"tertiary"},p({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};Y.defaultProps={next:null},Y.propTypes={goTo:C().func.isRequired,next:C().string,onClose:C().func.isRequired,setLocalImage:C().func.isRequired};const ve=Y;var E=t(11817);const Ie=async y=>{try{const m=await E.Z.get(y,{responseType:"blob",timeout:8e3});return new File([m.data],m.config.url,{type:m.headers["content-type"]})}catch(m){throw m.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},m}},Se=({goTo:y,next:m,onClose:g,setLocalImage:b})=>{const{formatMessage:p}=(0,c.useIntl)(),[Z,ae]=(0,e.useState)(""),[G,$]=(0,e.useState)(null),F=V=>{ae(V.target.value)},fe=async()=>{try{const V=await Ie(Z),Fe=await N(V);b(Fe),y(m)}catch(V){if(V.displayMessage)$(p(V.displayMessage,{size:ce,dimension:le}));else throw V}};return e.createElement("form",{onSubmit:V=>{V.preventDefault(),fe()}},e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.TextInput,{label:p({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:G,onChange:F,value:Z,name:"logo-url"})),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:g,variant:"tertiary"},p({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(r.Button,{type:"submit"},p({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};Se.defaultProps={next:null},Se.propTypes={goTo:C().func.isRequired,next:C().string,onClose:C().func.isRequired,setLocalImage:C().func.isRequired};const ne=Se,me=({setLocalImage:y,goTo:m,next:g,onClose:b})=>{const{formatMessage:p}=(0,c.useIntl)();return e.createElement(r.TabGroup,{label:p({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(r.Box,{paddingLeft:8,paddingRight:8},e.createElement(r.Tabs,null,e.createElement(r.Tab,null,p({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(r.Tab,null,p({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(r.Divider,null)),e.createElement(r.TabPanels,null,e.createElement(r.TabPanel,null,e.createElement(ve,{onClose:b,setLocalImage:y,goTo:m,next:g})),e.createElement(r.TabPanel,null,e.createElement(ne,{onClose:b,setLocalImage:y,goTo:m,next:g}))))};me.defaultProps={next:null},me.propTypes={goTo:C().func.isRequired,next:C().string,onClose:C().func.isRequired,setLocalImage:C().func.isRequired};const W=me,oe=({asset:y})=>{const{formatMessage:m}=(0,c.useIntl)();return e.createElement(r.Card,null,e.createElement(r.CardHeader,null,e.createElement(r.CardAsset,{size:"S",src:y.url})),e.createElement(r.CardBody,null,e.createElement(r.CardContent,null,e.createElement(r.CardTitle,null,y.name),e.createElement(r.CardSubtitle,null,`${y.ext.toUpperCase()} - ${y.width}\u2715${y.height}`)),e.createElement(r.CardBadge,null,m({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};oe.propTypes={asset:C().shape({name:C().string,url:C().string,width:C().number,height:C().number,ext:C().string}).isRequired};const Ve=oe,Oe=({onClose:y,asset:m,prev:g,next:b,goTo:p,setLocalImage:Z,onChangeLogo:ae})=>{const{formatMessage:G}=(0,c.useIntl)(),$=()=>{Z(void 0),p(g)},F=()=>{ae(m),p(b)};return e.createElement(e.Fragment,null,e.createElement(r.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(r.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(r.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(r.Typography,{variant:"pi",fontWeight:"bold"},G({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(r.Typography,{variant:"pi",textColor:"neutral500"},G({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(r.Button,{onClick:$,variant:"secondary"},G({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(r.Box,{maxWidth:(0,f.pxToRem)(180)},e.createElement(Ve,{asset:m}))),e.createElement(r.ModalFooter,{startActions:e.createElement(r.Button,{onClick:y,variant:"tertiary"},G({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(r.Button,{onClick:F},G({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Oe.defaultProps={next:null,prev:null},Oe.propTypes={goTo:C().func.isRequired,asset:C().shape({name:C().string,url:C().string,width:C().number,height:C().number,ext:C().string}).isRequired,next:C().string,onClose:C().func.isRequired,onChangeLogo:C().func.isRequired,prev:C().string,setLocalImage:C().func.isRequired};const Me={upload:{Component:W,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Oe,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Ye=({canUpdate:y,customLogo:m,defaultLogo:g,hint:b,label:p,onChangeLogo:Z,onResetLogo:ae})=>{const[{currentStep:G},$]=(0,e.useReducer)(X,L),{Component:F,next:fe,prev:V,modalTitle:Fe}=Me[G]||{},{formatMessage:Le}=(0,c.useIntl)(),Ne=He=>{$({type:"GO_TO",to:He})};return e.createElement(e.Fragment,null,e.createElement(r.CarouselInput,{label:p,selectedSlide:0,hint:b,previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:m?.name||"logo.png",actions:e.createElement(r.CarouselActions,null,e.createElement(r.IconButton,{disabled:!y,onClick:()=>Ne(m?"pending":"upload"),label:Le({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(j.Plus,null)}),m&&e.createElement(r.IconButton,{disabled:!y,onClick:ae,label:Le({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(j.Refresh,null)}))},e.createElement(r.CarouselSlide,{label:Le({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(r.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:m?.url||g,alt:Le({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(Ze,{Component:F,currentStep:G,onChangeLogo:Z,customLogo:m,goTo:Ne,next:fe,prev:V,modalTitle:Fe}))};Ye.defaultProps={canUpdate:!1,customLogo:null,hint:null},Ye.propTypes={canUpdate:C().bool,customLogo:C().shape({url:C().string,name:C().string}),label:C().string.isRequired,hint:C().string,defaultLogo:C().string.isRequired,onChangeLogo:C().func.isRequired,onResetLogo:C().func.isRequired};const at=Ye,st={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}},authLogo:{display:null,submit:{rawFile:null,isReset:!1}}},Qe=(y=st,m)=>(0,ee.default)(y,g=>{switch(m.type){case"SET_CUSTOM_MENU_LOGO":{g.menuLogo.display=m.value,g.menuLogo.submit.rawFile=m.value.rawFile;break}case"SET_CUSTOM_AUTH_LOGO":{g.authLogo.display=m.value,g.authLogo.submit.rawFile=m.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{g.menuLogo.display=null,g.menuLogo.submit={rawFile:null,isReset:!0};break}case"RESET_CUSTOM_AUTH_LOGO":{g.authLogo.display=null,g.authLogo.submit={rawFile:null,isReset:!0};break}default:return g}});var Jt=t(82492),lt=t.n(Jt);const Ke=(y,m)=>lt()(y,{menuLogo:{display:m.menuLogo},authLogo:{display:m.authLogo}}),gt=(0,e.forwardRef)(({canUpdate:y,projectSettingsStored:m},g)=>{const{formatMessage:b}=(0,c.useIntl)(),{trackUsage:p}=(0,f.useTracking)(),{logos:{menu:Z,auth:ae}}=(0,K.um)(),[{menuLogo:G,authLogo:$},F]=(0,e.useReducer)(Qe,st,()=>Ke(st,m)),fe=Ne=>{F({type:"SET_CUSTOM_MENU_LOGO",value:Ne})},V=()=>{p("didClickResetLogo",{logo:"menu"}),F({type:"RESET_CUSTOM_MENU_LOGO"})},Fe=Ne=>{F({type:"SET_CUSTOM_AUTH_LOGO",value:Ne})},Le=()=>{p("didClickResetLogo",{logo:"auth"}),F({type:"RESET_CUSTOM_AUTH_LOGO"})};return(0,e.useImperativeHandle)(g,()=>({getValues:()=>({menuLogo:G.submit,authLogo:$.submit})})),e.createElement(r.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(r.Typography,{variant:"delta",as:"h3"},b({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},b({id:"Settings.application.customization.size-details",defaultMessage:"Max dimension: {dimension}\xD7{dimension}, Max file size: {size}KB"},{dimension:le,size:ce})),e.createElement(r.Grid,{paddingTop:4,gap:4},e.createElement(r.GridItem,{col:6,s:12},e.createElement(at,{canUpdate:y,customLogo:G.display,defaultLogo:Z.default,hint:b({id:"Settings.application.customization.menu-logo.carousel-hint",defaultMessage:"Replace the logo in the main navigation"}),label:b({id:"Settings.application.customization.carousel.menu-logo.title",defaultMessage:"Menu logo"}),onChangeLogo:fe,onResetLogo:V})),e.createElement(r.GridItem,{col:6,s:12},e.createElement(at,{canUpdate:y,customLogo:$.display,defaultLogo:ae.default,hint:b({id:"Settings.application.customization.auth-logo.carousel-hint",defaultMessage:"Replace the logo in the authentication pages"}),label:b({id:"Settings.application.customization.carousel.auth-logo.title",defaultMessage:"Auth logo"}),onChangeLogo:Fe,onResetLogo:Le}))))});gt.defaultProps={canUpdate:!1,projectSettingsStored:null},gt.propTypes={canUpdate:C().bool,projectSettingsStored:C().shape({menuLogo:C().shape({url:C().string,name:C().string})})};const xt=gt;var qt=t(68718),_e=t.n(qt);const Je=y=>_e()(y,(m,g,b)=>{g&&g.url?m[b]={...g,url:(0,f.prefixFileUrlWithBackendUrl)(g.url)}:m[b]=g},{}),ht=async()=>{const{get:y}=(0,f.getFetchClient)(),{data:m}=await y("/admin/project-settings");return Je(m)},ft=async y=>{const{post:m}=(0,f.getFetchClient)(),{data:g}=await m("/admin/project-settings",y,{headers:{"Content-Type":"multipart/form-data"}});return Je(g)},Lt=y=>{const m=new FormData;return Object.entries(y).forEach(([g,b])=>{b&&b.rawFile instanceof File&&m.append(g,b.rawFile),b&&b.isReset&&m.append(g,null)}),m},yt=()=>{const y=(0,e.useRef)(),m=(0,f.useNotification)(),{trackUsage:g}=(0,f.useTracking)(),{formatMessage:b}=(0,c.useIntl)(),p=(0,ue.useQueryClient)();(0,f.useFocusWhenNavigate)();const Z=(0,f.useAppInfos)(),{latestStrapiReleaseTag:ae,shouldUpdateStrapi:G,strapiVersion:$}=Z,{updateProjectSettings:F}=(0,K.um)(),{allowedActions:{canRead:fe,canUpdate:V}}=(0,f.useRBAC)(x.Z.settings["project-settings"]),Fe=fe&&V,{data:Le}=(0,ue.useQuery)("project-settings",ht,{enabled:fe}),Ne=(0,ue.useMutation)(je=>ft(je),{async onSuccess({menuLogo:je,authLogo:tt}){await p.invalidateQueries("project-settings",{refetchActive:!0}),F({menuLogo:je?.url,authLogo:tt?.url})}}),He=je=>{if(je.preventDefault(),!V)return;const tt=y.current.getValues(),zt=Lt(tt);Ne.mutate(zt,{onSuccess(){const{menuLogo:mt,authLogo:Wt}=tt;mt.rawFile&&g("didChangeLogo",{logo:"menu"}),Wt.rawFile&&g("didChangeLogo",{logo:"auth"}),m({type:"success",message:b({id:"app",defaultMessage:"Saved"})})},onError(){m({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(r.Layout,null,e.createElement(f.SettingsPageTitle,{name:"Application"}),e.createElement(r.Main,null,e.createElement("form",{onSubmit:He},e.createElement(r.HeaderLayout,{title:b({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:b({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:Fe&&e.createElement(r.Button,{type:"submit",startIcon:e.createElement(j.Check,null)},b({id:"global.save",defaultMessage:"Save"}))}),e.createElement(r.ContentLayout,null,e.createElement(r.Stack,{spacing:6},e.createElement(r.Stack,{spacing:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(r.Typography,{variant:"delta",as:"h3"},b({id:"global.details",defaultMessage:"Details"})),e.createElement(r.Grid,{gap:5,as:"dl"},e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},b({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(r.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(r.Typography,null,"v",$),G&&e.createElement(r.Link,{href:`https://github.com/strapi/strapi/releases/tag/${ae}`,isExternal:!0,endIcon:e.createElement(j.ExternalLink,null)},b({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"})))),e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},b({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(r.Flex,{gap:3,direction:"column",alignItems:"start",as:"dd"},e.createElement(r.Typography,null,b({id:"Settings.application.ee-or-ce",defaultMessage:"{communityEdition, select, true {Community Edition} other {Enterprise Edition}}"},{communityEdition:Z.communityEdition})),e.createElement(r.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(j.ExternalLink,null)},b({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(r.GridItem,{col:6,s:12},e.createElement(r.Typography,{variant:"sigma",textColor:"neutral600",as:"dt"},b({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(r.Typography,{as:"dd"},Z.nodeVersion)))),fe&&Le&&e.createElement(xt,{canUpdate:V,ref:y,projectSettingsStored:Le}))))))};var Ct=t(94654),Pt=t.n(Ct);const Ot=y=>Pt()(y,g=>g.links).map(g=>(0,Q.ot)(g.Component,g.to,g.exact||!1)),Ft=y=>y.filter(m=>!m.links.every(g=>g.isDisplayed===!1));var ct=t(42982),Ge=t(15861),Et=t(64687),se=t.n(Et),et=function(){return window&&window.strapi&&window.strapi.isEE?t(26789).Z:t(73871).Z}(),Bt=function(){return window&&window.strapi&&window.strapi.isEE?t(64527).Z:t(85302).Z}(),_t=[{Component:function(){return{default:Bt}},to:"/settings/roles",exact:!0},{Component:function(){return{default:et}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:et}},to:"/settings/roles/new",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(2544).then(t.bind(t,92100));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/roles/:id",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(5199).then(t.bind(t,35097));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/users",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(4263).then(t.bind(t,22282));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/users/:id",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(5162).then(t.bind(t,3672));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/webhooks/create",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(5162).then(t.bind(t,9311));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/webhooks/:id",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(4121).then(t.bind(t,6784));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/webhooks",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,t.e(8056).then(t.bind(t,8421));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/api-tokens",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([t.e(153),t.e(7375),t.e(4299)]).then(t.bind(t,9683));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/api-tokens/create",exact:!0},{Component:function(){return(0,Ge.Z)(se().mark(function m(){var g;return se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([t.e(153),t.e(7375),t.e(92)]).then(t.bind(t,28465));case 2:return g=p.sent,p.abrupt("return",g);case 4:case"end":return p.stop()}},m)}))()},to:"/settings/api-tokens/:id",exact:!0}];const bt=_t;var en=function(){return window&&window.strapi&&window.strapi.isEE?t(5420).Z:t(35301).Z}();const kt=[].concat((0,ct.Z)(en),(0,ct.Z)(bt));var wt=t(92978),Nt=t(18386),jt=t(34446),dt=t(29489),$t=t(52305);const ut=({menu:y})=>{const{formatMessage:m}=(0,c.useIntl)(),{trackUsage:g}=(0,f.useTracking)(),{pathname:b}=(0,s.useLocation)(),Z=Ft(y).map($=>({...$,title:$.intlLabel,links:$.links.map(F=>({...F,title:F.intlLabel,name:F.id}))})),ae=m({id:"global.settings",defaultMessage:"Settings"}),G=($=null)=>{g("willNavigate",{from:b,to:$})};return e.createElement(wt.m,{ariaLabel:ae},e.createElement(Nt.p,{label:ae}),e.createElement(jt.Z,null,Z.map($=>e.createElement(dt.D,{key:$.id,label:m($.intlLabel)},$.links.map(F=>e.createElement($t.E,{as:s.NavLink,withBullet:F.hasNotification,to:F.to,onClick:()=>G(F.to),key:F.id},m(F.intlLabel)))))))};ut.propTypes={menu:C().array.isRequired};const vt=ut;function St(){const{settingId:y}=(0,s.useParams)(),{settings:m}=(0,f.useStrapiApp)(),{formatMessage:g}=(0,c.useIntl)(),{isLoading:b,menu:p}=(0,K.Te)(),Z=(0,e.useMemo)(()=>(0,Q.WW)(kt.map(({to:$,Component:F,exact:fe})=>(0,Q.ot)(F,$,fe))),[]),ae=Ot(m);if(b)return e.createElement(f.LoadingIndicatorPage,null);if(!y)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const G=g({id:"global.settings",defaultMessage:"Settings"});return e.createElement(r.Layout,{sideNav:e.createElement(vt,{menu:p})},e.createElement(T.Helmet,{title:G}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:yt,exact:!0}),Z,ae))}const Ut=(0,e.memo)(St)},73871:(k,R,t)=>{"use strict";t.d(R,{Z:()=>r});var e=t(67294),f=t(49656);const r=()=>e.createElement(f.Redirect,{to:"/404"})},79578:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},56195:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},35820:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},53558:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},99047:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},28834:(k,R,t)=>{"use strict";t.d(R,{Z:()=>_n});var e=t(67294),f=t(45697),s=t.n(f),r=t(95489),c=t(28702),T=t(18721),K=t.n(T),Q=t(41609),ue=t.n(Q),j=t(97132),x=t(27821),ke=t(89734),C=t.n(ke),le=t(70885),ce=t(41363),Ue=t(27361),ee=t.n(Ue),ze=t(57557),we=t.n(ze),Ee=t(48474);const We=x.default.div`
  position: relative;

  ${({hasConditions:o,disabled:n,theme:a})=>o&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${n?a.colors.neutral100:a.colors.primary600};
    }
  `}
`,Ze=({onClick:o,className:n,hasConditions:a,variant:i})=>{const{formatMessage:l}=(0,j.useIntl)();return e.createElement(We,{hasConditions:a,className:n},e.createElement(c.Button,{variant:i,startIcon:e.createElement(ce.Cog,null),onClick:o},l({id:"global.settings",defaultMessage:"Settings"})))};Ze.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},Ze.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const L=(0,x.default)(Ze)``;var he=t(18172),X=t(7739),w=t.n(X),be=t(11700),J=t.n(be);const Pe=o=>Object.values(o).map(n=>Object.entries(n).filter(([,a])=>a).map(([a])=>a)).flat(),D=o=>o.reduce((n,[a,i])=>(n.push({label:J()(a),children:i.map(l=>({label:l.displayName,value:l.id}))}),n),[]),N=(o,n)=>o.map(([,a])=>a).flat().reduce((a,i)=>({[i.id]:n.includes(i.id),...a}),{});var q=function(){return window&&window.strapi&&window.strapi.isEE?t(53273).Z:t(79578).Z}(),Y=function(n){var a=n.arrayOfOptionsGroupedByCategory,i=n.isFormDisabled,l=n.isGrey,d=n.label,u=n.name,h=n.onChange,v=n.value,S=(0,j.useIntl)(),A=S.formatMessage,M=function(U){h(u,N(a,U))};return e.createElement(c.Flex,{as:"li",background:l?"neutral100":"neutral0",paddingBottom:3,paddingTop:3},e.createElement(c.Flex,{paddingLeft:6,style:{width:180}},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},A({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(c.Typography,{variant:"sigma",title:d,textColor:"primary600",ellipsis:!0},A({id:"Settings.roles.form.permissions.".concat(d.toLowerCase()),defaultMessage:d})),e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",A({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(c.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(c.MultiSelectNested,{id:u,customizeContent:function(U){return"".concat(U.length," currently selected")},onChange:M,value:Pe(v),options:D(a),disabled:i||q})))};Y.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const ve=Y;var E=t(96486);const xe=(o,n)=>o.reduce((a,i)=>(a[i.id]=(0,E.get)(n,i.id,!1),a),{}),Ie=(o,n)=>o.reduce((a,i)=>{const[l,d]=i,u=xe(d,n);return a[l]=u,a},{}),ne=(o,n,a)=>o.reduce((i,l)=>{const d=(0,E.get)(n,[...l.pathToConditionsObject,"conditions"],{}),u=Ie(a,d);return i[l.pathToConditionsObject.join("..")]=u,i},{}),me=({actions:o,headerBreadCrumbs:n,isFormDisabled:a,onClosed:i,onToggle:l})=>{const{formatMessage:d}=(0,j.useIntl)(),{availableConditions:u,modifiedData:h,onChangeConditions:v}=(0,Ee.$_)(),S=(0,e.useMemo)(()=>Object.entries(w()(u,"category")),[u]),A=o.filter(({isDisplayed:P,hasSomeActionsSelected:B,hasAllActionsSelected:H})=>P&&(B||H)),M=(0,e.useMemo)(()=>ne(A,h,S),[A,h,S]),[I,U]=(0,e.useState)(M),O=(P,B)=>{U((0,he.default)(H=>{H[P]||(H[P]={}),H[P].default||(H[P].default={}),H[P].default=B}))},z=()=>{const P=Object.entries(I).reduce((B,H)=>{const[ie,$e]=H,ye=Object.values($e).reduce((pe,Te)=>({...pe,...Te}),{});return B[ie]=ye,B},{});v(P),l()};return e.createElement(c.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:i},e.createElement(c.ModalHeader,null,e.createElement(c.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:n.join(", ")},n.map(P=>e.createElement(c.Crumb,{key:P},J()(d({id:P,defaultMessage:P})))))),e.createElement(c.ModalBody,null,A.length===0&&e.createElement(c.Typography,null,d({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,A.map(({actionId:P,label:B,pathToConditionsObject:H},ie)=>{const $e=H.join("..");return e.createElement(ve,{key:P,arrayOfOptionsGroupedByCategory:S,label:B,isFormDisabled:a,isGrey:ie%2===0,name:$e,onChange:O,value:ee()(I,$e,{})})}))),e.createElement(c.ModalFooter,{startActions:e.createElement(c.Button,{variant:"tertiary",onClick:l},d({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(c.Button,{onClick:z},d({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};me.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const W=me,oe=`${120/16}rem`,Ve=`${200/16}rem`,Oe=`${53/16}rem`,_=x.default.div`
  width: ${oe};
`,Ye=(0,x.default)(c.Flex)`
  padding-right: ${({theme:o})=>o.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:o})=>o&&"cursor: pointer;"}
`,at=({children:o,isCollapsable:n,isActive:a,isFormDisabled:i,label:l,onChange:d,onClick:u,checkboxName:h,someChecked:v,value:S})=>{const{formatMessage:A}=(0,j.useIntl)();return e.createElement(c.Flex,{alignItems:"center",paddingLeft:6,style:{width:Ve,flexShrink:0}},e.createElement(c.Box,{paddingRight:2},e.createElement(c.BaseCheckbox,{name:h,"aria-label":A({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:l}),disabled:i,onValueChange:M=>d({target:{name:h,value:M}}),indeterminate:v,value:S})),e.createElement(Ye,{title:l,alignItems:"center",isCollapsable:n,...n&&{onClick:u,"aria-expanded":a,onKeyDown:({key:M})=>(M==="Enter"||M===" ")&&u(),tabIndex:0,role:"button"}},e.createElement(c.Typography,{fontWeight:a?"bold":"",textColor:a?"primary600":"neutral800",ellipsis:!0},J()(l)),o))};at.defaultProps={children:null,checkboxName:"",onChange(){},value:!1,someChecked:!1,isCollapsable:!1},at.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const st=(0,e.memo)(at),Rt=o=>(0,E.isObject)(o)?(0,E.flattenDeep)(Object.values(o).map(n=>(0,E.isObject)(n)?Rt(n):n)):[],Qe=Rt,lt=o=>o?Object.keys(o).reduce((n,a)=>(a!=="conditions"&&(n[a]=o[a]),n),{}):null,Ke=o=>{const n=lt(o),a=Qe(n);if(!a.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const i=a.every(d=>d),l=a.some(d=>d)&&!i;return{hasAllActionsSelected:i,hasSomeActionsSelected:l}},xt=(o,n,a)=>o.map(({actionId:i,isDisplayed:l,applyToProperties:d,label:u})=>{if(!l)return{actionId:i,hasSomeActionsSelected:!1,isDisplayed:l};const h=[...a.split(".."),i],v=(0,E.isEmpty)(d)?[...h,"properties","enabled"]:h,S=v.join(".."),A=(0,E.get)(n,[...h,"conditions"],null),M=Qe(A).some(z=>z);if((0,E.isEmpty)(d)){const z=(0,E.get)(n,v,!1);return{actionId:i,checkboxName:S,hasAllActionsSelected:z,hasConditions:M,hasSomeActionsSelected:z,isDisplayed:l,isParentCheckbox:!1,label:u,pathToConditionsObject:h}}const I=(0,E.get)(n,v,null),{hasAllActionsSelected:U,hasSomeActionsSelected:O}=Ke(I);return{actionId:i,checkboxName:S,hasAllActionsSelected:U,hasConditions:M,hasSomeActionsSelected:O,isDisplayed:l,isParentCheckbox:!0,label:u,pathToConditionsObject:h}}),_e=(0,x.default)(ce.CarretDown)`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:o})=>o?"180":"0"}deg);
  margin-left: ${({theme:o})=>o.spaces[2]};
`,Je=o=>`
  ${c.Typography} {
    color: ${o.colors.primary600};
    font-weight: ${o.fontWeights.bold}
  }
  ${_e} {
    display: block;
    path {
      fill: ${o.colors.primary600}
    };
  }
`;var ht=function(){return window&&window.strapi&&window.strapi.isEE?t(20591).Z:t(56195).Z}(),ft=function o(n,a){return`
  `.concat(Mt,` {
    background-color: `).concat(n.colors.primary100,`;
    color: `).concat(n.colors.primary600,`;
    border-radius: `).concat(a?"2px 2px 0 0":"2px",`;
  }
  `).concat(yt,` {
    display: flex;
  }
  `).concat(L,` {
    display: block;
  }
  &:hover {
   `).concat(Je(n),`
  }

  &:focus-within {
    `).concat(function(i){var l=i.theme,d=i.isActive;return o(l,d)},`
  }
  
`)},Mt=x.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],Oe,function(o){var n=o.isGrey,a=o.theme;return n?a.colors.neutral100:a.colors.neutral0}),Lt=x.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],L,function(o){var n=o.isActive,a=o.theme;return n&&ft(a,n)},function(o){var n=o.theme,a=o.isActive;return ft(n,a)}),Dt=(0,x.default)(c.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],oe),yt=(0,x.default)(c.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(o){var n=o.theme;return n.colors.primary600}),Ct=x.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(o){var n=o.theme;return n.colors.primary600}),Pt=(0,x.default)(c.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),It=function(n){var a=n.availableActions,i=n.isActive,l=n.isGrey,d=n.isFormDisabled,u=n.label,h=n.onClickToggle,v=n.pathToData,S=(0,e.useState)(!1),A=(0,le.Z)(S,2),M=A[0],I=A[1],U=(0,j.useIntl)(),O=U.formatMessage,z=(0,Ee.$_)(),P=z.modifiedData,B=z.onChangeParentCheckbox,H=z.onChangeSimpleCheckbox,ie=function(){I(function(de){return!de})},$e=function(){I(!1)},ye=ee()(P,v.split(".."),{}),pe=(0,e.useMemo)(function(){return Object.keys(ye).reduce(function(te,de){return te[de]=we()(ye[de],"conditions"),te},{})},[ye]),Te=Ke(pe),Ce=Te.hasAllActionsSelected,nt=Te.hasSomeActionsSelected,re=(0,e.useMemo)(function(){return xt(a,P,v)},[a,P,v]),Ae=re.some(function(te){var de=te.hasConditions;return de});return e.createElement(Lt,{isActive:i},e.createElement(Mt,{isGrey:l},e.createElement(st,{isCollapsable:!0,isFormDisabled:d,label:u,checkboxName:v,onChange:B,onClick:h,someChecked:nt,value:Ce,isActive:i},e.createElement(yt,{paddingLeft:2},i?e.createElement(ce.ChevronUp,null):e.createElement(ce.ChevronDown,null))),e.createElement(c.Flex,{style:{flex:1}},re.map(function(te){var de=te.actionId,ge=te.hasConditions,Re=te.hasAllActionsSelected,De=te.hasSomeActionsSelected,qe=te.isDisplayed,Be=te.isParentCheckbox,Xe=te.checkboxName,it=te.label;return qe?Be?e.createElement(Dt,{key:de,justifyContent:"center",alignItems:"center"},ge&&e.createElement(Ct,null),e.createElement(c.BaseCheckbox,{disabled:d||ht,name:Xe,"aria-label":O({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(it," ").concat(u)}),onValueChange:function(ot){B({target:{name:Xe,value:ot}})},indeterminate:De,value:Re})):e.createElement(Dt,{key:de,justifyContent:"center",alignItems:"center"},ge&&e.createElement(Ct,null),e.createElement(c.BaseCheckbox,{disabled:d||ht,indeterminate:ge,name:Xe,onValueChange:function(ot){H({target:{name:Xe,value:ot}})},value:Re})):e.createElement(_,{key:de})})),M&&e.createElement(W,{headerBreadCrumbs:[u,"Settings.permissions.conditions.conditions"],actions:re,isFormDisabled:d,onClosed:$e,onToggle:ie})),e.createElement(Pt,null,e.createElement(L,{onClick:ie,hasConditions:Ae})))};It.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const Ot=It,Ft=(o,n)=>o.map(a=>{const i=Array.isArray(a.applyToProperties)&&a.applyToProperties.indexOf(n)!==-1&&a.isDisplayed;return{label:a.label,actionId:a.actionId,isActionRelatedToCurrentProperty:i}}),ct=(0,x.default)(c.Flex)`
  width: ${oe};
  flex-shrink: 0;
`,Ge=(0,x.default)(c.Flex)`
  width: ${Ve};
  height: ${Oe};
  flex-shrink: 0;
`,Et=({headers:o,label:n})=>{const{formatMessage:a}=(0,j.useIntl)(),i=a({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:n});return e.createElement(c.Flex,null,e.createElement(Ge,{alignItems:"center",paddingLeft:6},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},i)),o.map(l=>l.isActionRelatedToCurrentProperty?e.createElement(ct,{justifyContent:"center",key:l.label},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},a({id:`Settings.roles.form.permissions.${l.label.toLowerCase()}`,defaultMessage:l.label}))):e.createElement(ct,{key:l.label})))};Et.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const se=Et;var et=t(42982);const Bt=x.default.span`
  color: ${({theme:o})=>o.colors.danger700};
  padding-left: ${({theme:o})=>o.spaces[1]}px;
`,bt=()=>e.createElement(Bt,null,"*"),kt=(o,n)=>o.map(a=>{const i=Array.isArray(a.subjects)&&a.subjects.indexOf(n)!==-1;return{...a,isDisplayed:i}});var wt=t(87462);const Nt=(0,x.default)(c.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:o})=>o.colors.primary200};
    display: block;
  }
`,jt=x.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:o,color:n})=>o.colors[n]};
  }
`,dt=o=>e.createElement(Nt,null,e.createElement(jt,{width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...o},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));dt.defaultProps={fill:"primary200"},dt.propTypes={fill:s().string};const $t=(0,e.memo)(dt);var ut=function(){return window&&window.strapi&&window.strapi.isEE?t(76766).Z:t(53558).Z}(),vt=(0,x.default)(c.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],oe),St=(0,x.default)(c.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],Oe),Ut=(0,x.default)(c.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),y=(0,x.default)(c.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(o){var n=o.isVisible,a=o.theme;return n?"4px solid ".concat(a.colors.primary200):"4px solid transparent"}),m=(0,x.default)(c.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(o){var n=o.theme;return n.spaces[4]},function(o){var n=o.level;return 145-n*36},function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(_e,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(Je(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&Je(a)}),g=x.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(o){var n=o.theme;return n.spaces[2]},function(o){var n=o.theme;return n.spaces[2]},4/16,function(o){var n=o.theme;return n.colors.primary200}),b=function o(n){var a=n.childrenForm,i=n.isFormDisabled,l=n.recursiveLevel,d=n.pathToDataFromActionRow,u=n.propertyActions,h=n.parentName,v=n.propertyName,S=(0,j.useIntl)(),A=S.formatMessage,M=(0,Ee.$_)(),I=M.modifiedData,U=M.onChangeParentCheckbox,O=M.onChangeSimpleCheckbox,z=(0,e.useState)(null),P=(0,le.Z)(z,2),B=P[0],H=P[1],ie=function(pe){H(function(Te){return Te===pe?null:pe})},$e=(0,e.useMemo)(function(){return B?a.find(function(ye){var pe=ye.value;return pe===B}):null},[B,a]);return e.createElement(Ut,null,e.createElement(g,null),a.map(function(ye,pe){var Te=ye.label,Ce=ye.value,nt=ye.required,re=ye.children,Ae=pe+1<a.length,te=Array.isArray(re),de=B===Ce;return e.createElement(y,{key:Ce,isVisible:Ae},e.createElement(St,null,e.createElement($t,{color:"primary200"}),e.createElement(c.Flex,{style:{flex:1}},e.createElement(m,{level:l,isActive:de,isCollapsable:te},e.createElement(Ye,(0,wt.Z)({alignItems:"center",isCollapsable:te},te&&{onClick:function(){return ie(Ce)},"aria-expanded":de,onKeyDown:function(Re){var De=Re.key;return(De==="Enter"||De===" ")&&ie(Ce)},tabIndex:0,role:"button"},{title:Te}),e.createElement(c.Typography,{ellipsis:!0},J()(Te)),nt&&e.createElement(bt,null),e.createElement(_e,{$isActive:de}))),e.createElement(c.Flex,{style:{flex:1}},u.map(function(ge){var Re=ge.actionId,De=ge.label,qe=ge.isActionRelatedToCurrentProperty;if(!qe)return e.createElement(_,{key:Re});var Be=[].concat((0,et.Z)(d.split("..")),[Re,"properties",v],(0,et.Z)(h.split("..")),[Ce]),Xe=ee()(I,Be,!1);if(!re)return e.createElement(vt,{key:De,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:i||ut,name:Be.join(".."),"aria-label":A({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Te," ").concat(De)}),onValueChange:function(pt){O({target:{name:Be.join(".."),value:pt}})},value:Xe}));var it=Ke(Xe),rt=it.hasAllActionsSelected,ot=it.hasSomeActionsSelected;return e.createElement(vt,{key:De,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{key:De,disabled:i||ut,name:Be.join(".."),"aria-label":A({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(Te," ").concat(De)}),onValueChange:function(pt){U({target:{name:Be.join(".."),value:pt}})},value:rt,indeterminate:ot}))})))),$e&&de&&e.createElement(c.Box,{paddingBottom:2},e.createElement(o,{isFormDisabled:i,parentName:"".concat(h,"..").concat(Ce),pathToDataFromActionRow:d,propertyActions:u,propertyName:v,recursiveLevel:l+1,childrenForm:$e.children})))}))};b.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const p=(0,e.memo)(b),Z=o=>o.reduce((a,i)=>(i.isActionRelatedToCurrentProperty&&a.push(i.actionId),a),[]),G=(o,n,a,i,l)=>{const u=Z(o).reduce((h,v)=>{const S=[...a.split(".."),v,"properties",i,l],A=(0,E.get)(n,S,!1);return h[v]=A,h},{});return Ke(u)};var $=function(){return window&&window.strapi&&window.strapi.isEE?t(74512).Z:t(35820).Z}(),F=(0,x.default)(c.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],oe),fe=(0,x.default)(c.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],Oe,function(o){var n=o.isCollapsable,a=o.theme;return n&&`
      `.concat(_e,` {
        display: block;
        color: `).concat(a.colors.neutral100,`;
      }
      &:hover {
        `).concat(Je(a),`
      }
  `)},function(o){var n=o.isActive,a=o.theme;return n&&Je(a)}),V=function(n){var a=n.childrenForm,i=n.label,l=n.isFormDisabled,d=n.name,u=n.required,h=n.pathToData,v=n.propertyActions,S=n.propertyName,A=n.isOdd,M=(0,j.useIntl)(),I=M.formatMessage,U=(0,e.useState)(null),O=(0,le.Z)(U,2),z=O[0],P=O[1],B=(0,Ee.$_)(),H=B.modifiedData,ie=B.onChangeCollectionTypeLeftActionRowCheckbox,$e=B.onChangeParentCheckbox,ye=B.onChangeSimpleCheckbox,pe=z===d,Te=(0,e.useMemo)(function(){return Array.isArray(a)?a:[]},[a]),Ce=Te.length>0,nt=(0,e.useCallback)(function(){Ce&&P(function(ge){return ge===d?null:d})},[Ce,d]),re=function(Re){var De=Re.target.value;ie(h,S,d,De)},Ae=(0,e.useMemo)(function(){return G(v,H,h,S,d)},[v,H,h,S,d]),te=Ae.hasAllActionsSelected,de=Ae.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(fe,{alignItems:"center",isCollapsable:Ce,isActive:pe,background:A?"neutral100":"neutral0"},e.createElement(c.Flex,null,e.createElement(st,{onChange:re,onClick:nt,isCollapsable:Ce,isFormDisabled:l,label:i,someChecked:de,value:te,isActive:pe},u&&e.createElement(bt,null),e.createElement(_e,{$isActive:pe})),e.createElement(c.Flex,null,v.map(function(ge){var Re=ge.label,De=ge.isActionRelatedToCurrentProperty,qe=ge.actionId;if(!De)return e.createElement(_,{key:Re});var Be=[].concat((0,et.Z)(h.split("..")),[qe,"properties",S,d]);if(!Ce){var Xe=ee()(H,Be,!1);return e.createElement(F,{key:qe,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:l||$,name:Be.join(".."),"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(Re)}),onValueChange:function(Qt){ye({target:{name:Be.join(".."),value:Qt}})},value:Xe}))}var it=ee()(H,Be,{}),rt=Ke(it),ot=rt.hasAllActionsSelected,Yt=rt.hasSomeActionsSelected;return e.createElement(F,{key:Re,justifyContent:"center",alignItems:"center"},e.createElement(c.BaseCheckbox,{disabled:l||$,name:Be.join(".."),onValueChange:function(Qt){$e({target:{name:Be.join(".."),value:Qt}})},"aria-label":I({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(Re)}),value:ot,indeterminate:Yt}))})))),pe&&e.createElement(p,{childrenForm:Te,isFormDisabled:l,parentName:d,pathToDataFromActionRow:h,propertyName:S,propertyActions:v,recursiveLevel:0}))};V.defaultProps={childrenForm:[],required:!1},V.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const Fe=(0,e.memo)(V),Le=x.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,Ne=({availableActions:o,childrenForm:n,isFormDisabled:a,label:i,pathToData:l,propertyName:d})=>{const u=(0,e.useMemo)(()=>Ft(o,d),[o,d]);return e.createElement(Le,null,e.createElement(se,{label:i,headers:u}),e.createElement(c.Box,null,n.map(({children:h,label:v,value:S,required:A},M)=>e.createElement(Fe,{childrenForm:h,key:S,label:v,isFormDisabled:a,name:S,required:A,propertyActions:u,pathToData:l,propertyName:d,isOdd:M%2===0}))))};Ne.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const He=Ne,je=x.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:o,isActive:n})=>n&&`border: 1px solid ${o.colors.primary600};`}
`,tt=({allActions:o,contentTypeName:n,label:a,index:i,isActive:l,isFormDisabled:d,onClickToggleCollapse:u,pathToData:h,properties:v})=>{const S=(0,e.useCallback)(()=>{u(n)},[n,u]),A=(0,e.useMemo)(()=>kt(o,n),[o,n]);return e.createElement(je,{isActive:l},e.createElement(Ot,{availableActions:A,isActive:l,isGrey:i%2===0,isFormDisabled:d,label:a,onClickToggle:S,pathToData:h}),l&&v.map(({label:M,value:I,children:U})=>e.createElement(He,{availableActions:A,childrenForm:U,isFormDisabled:d,label:M,pathToData:h,propertyName:I,key:I})))};tt.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const zt=tt,mt=({actions:o,isFormDisabled:n,pathToData:a,subjects:i})=>{const[l,d]=(0,e.useState)(null),u=h=>{d(l===h?null:h)};return i.map(({uid:h,label:v,properties:S},A)=>e.createElement(zt,{allActions:o,key:h,contentTypeName:h,label:v,isActive:l===h,isFormDisabled:n,index:A,onClickToggleCollapse:u,pathToData:`${a}..${h}`,properties:S}))};mt.defaultProps={actions:[],subjects:[]},mt.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const Wt=(0,e.memo)(mt),Tn=o=>o.filter(({subjects:n})=>n&&n.length),An=o=>o.map(({actionId:n})=>n),Rn=(o,n)=>o.reduce((a,i)=>(Object.keys(n).forEach(l=>{const d=(0,E.get)(n,[l,i],{}),u={[l]:lt(d)};a[i]?a[i]={...a[i],...u}:a[i]=u}),a),{}),xn=(o,n)=>{const a=An(o),i=Rn(a,n);return Object.keys(i).reduce((d,u)=>(d[u]=Ke(i[u]),d),{})};var Mn=function(){return window&&window.strapi&&window.strapi.isEE?t(85822).Z:t(99047).Z}(),Ln=(0,x.default)(c.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],oe),Zt=function(n){var a=n.actions,i=n.isFormDisabled,l=n.kind,d=(0,j.useIntl)(),u=d.formatMessage,h=(0,Ee.$_)(),v=h.modifiedData,S=h.onChangeCollectionTypeGlobalActionCheckbox,A=(0,e.useMemo)(function(){return Tn(a)},[a]),M=(0,e.useMemo)(function(){return xn(A,v[l])},[v,A,l]);return e.createElement(c.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:Ve}},e.createElement(c.Stack,{horizontal:!0,spacing:0},A.map(function(I){var U=I.label,O=I.actionId;return e.createElement(Ln,{key:O,spacing:3},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral500"},u({id:"Settings.roles.form.permissions.".concat(U.toLowerCase()),defaultMessage:U})),e.createElement(c.BaseCheckbox,{disabled:i||Mn,onValueChange:function(P){S(l,O,P)},name:O,"aria-label":u({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:u({id:"Settings.roles.form.permissions.".concat(U.toLowerCase()),defaultMessage:U})}),value:ee()(M,[O,"hasAllActionsSelected"],!1),indeterminate:ee()(M,[O,"hasSomeActionsSelected"],!1)}))})))};Zt.defaultProps={actions:[]},Zt.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const Dn=(0,e.memo)(Zt),Pn=(0,x.default)(c.Box)`
  overflow-x: auto;
`,tn=({isFormDisabled:o,kind:n,layout:{actions:a,subjects:i}})=>{const l=C()([...i],"label");return e.createElement(Pn,{background:"neutral0"},e.createElement(Dn,{actions:a,kind:n,isFormDisabled:o}),e.createElement(Wt,{actions:a,isFormDisabled:o,pathToData:n,subjects:l}))};tn.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const nn=(0,e.memo)(tn);var In=t(47713);const on=({children:o,value:n})=>e.createElement(In.$l.Provider,{value:n},o);on.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const On=on,Fn=(o,n,a)=>o.map(i=>{const l=[...a,i.action,"properties","enabled"],d=(0,E.get)(n,l,!1),u=(0,E.get)(n,[...a,i.action,"conditions"],{}),h=Qe(u).some(v=>v);return{...i,isDisplayed:d,checkboxName:l.join(".."),hasSomeActionsSelected:d,value:d,hasConditions:h,label:i.displayName,actionId:i.action,pathToConditionsObject:[...a,i.action]}}),Bn=o=>{const n=Object.entries(o).reduce((i,l)=>{const[d,{conditions:u}]=l;return i[d]=u,i},{});return Qe(n).some(i=>i)};var Gt=function(){return window&&window.strapi&&window.strapi.isEE?t(8629).Z:t(34341).Z}(),kn=x.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(o){var n=o.theme;return n.colors.neutral150}),wn=x.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(o){var n=o.hasConditions,a=o.disabled,i=o.theme;return n&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(a?i.colors.neutral100:i.colors.primary600,`;
    }
  `)}),an=function(n){var a=n.categoryName,i=n.isFormDisabled,l=n.subCategoryName,d=n.actions,u=n.pathToData,h=(0,e.useState)(!1),v=(0,le.Z)(h,2),S=v[0],A=v[1],M=(0,Ee.$_)(),I=M.modifiedData,U=M.onChangeParentCheckbox,O=M.onChangeSimpleCheckbox,z=(0,j.useIntl)(),P=z.formatMessage,B=ee()(I,u,{}),H=(0,e.useMemo)(function(){return Object.keys(B).reduce(function(re,Ae){return re[Ae]=lt(B[Ae]),re},{})},[B]),ie=Ke(H),$e=ie.hasAllActionsSelected,ye=ie.hasSomeActionsSelected,pe=function(){A(function(Ae){return!Ae})},Te=function(){A(!1)},Ce=Fn(d,I,u),nt=Bn(ee()(I,(0,et.Z)(u),{}));return e.createElement(e.Fragment,null,e.createElement(c.Box,null,e.createElement(c.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(c.Box,{paddingRight:4},e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},l)),e.createElement(kn,null),e.createElement(c.Box,{paddingLeft:4},e.createElement(c.Checkbox,{name:u.join(".."),disabled:i||Gt,onValueChange:function(Ae){U({target:{name:u.join(".."),value:Ae}})},indeterminate:ye,value:$e},P({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(c.Flex,{paddingTop:6,paddingBottom:6},e.createElement(c.Grid,{gap:2,style:{flex:1}},Ce.map(function(re){var Ae=re.checkboxName,te=re.value,de=re.action,ge=re.displayName,Re=re.hasConditions;return e.createElement(c.GridItem,{col:3,key:de},e.createElement(wn,{disabled:i||Gt,hasConditions:Re},e.createElement(c.Checkbox,{name:Ae,disabled:i||Gt,onValueChange:function(qe){O({target:{name:Ae,value:qe}})},value:te},ge)))})),e.createElement(L,{hasConditions:nt,onClick:pe}))),S&&e.createElement(W,{headerBreadCrumbs:[a,l],actions:Ce,isFormDisabled:i,onClosed:Te,onToggle:pe}))};an.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const Nn=an,Vt=({childrenForm:o,kind:n,name:a,isOpen:i,isFormDisabled:l,isWhite:d,onOpenCategory:u,pathToData:h})=>{const{formatMessage:v}=(0,j.useIntl)(),S=()=>{u(a)},A=(0,e.useMemo)(()=>a.split("::").pop(),[a]);return e.createElement(c.Accordion,{expanded:i,onToggle:S,id:`accordion-${a}`,variant:d?"primary":"secondary"},e.createElement(c.AccordionToggle,{title:J()(A),description:`${v({id:"Settings.permissions.category"},{category:A})} ${n==="plugins"?"plugin":n}`}),e.createElement(c.AccordionContent,null,e.createElement(c.Box,{padding:6},o.map(({actions:M,subCategoryName:I,subCategoryId:U})=>e.createElement(Nn,{key:I,actions:M,categoryName:A,isFormDisabled:l,subCategoryName:I,pathToData:[...h,U]})))))};Vt.defaultProps={},Vt.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const jn=Vt,sn=({isFormDisabled:o,kind:n,layout:a})=>{const[i,l]=(0,e.useState)(null),d=u=>{l(u===i?null:u)};return e.createElement(c.Box,{padding:6,background:"neutral0"},a.map(({category:u,categoryId:h,childrenForm:v},S)=>e.createElement(jn,{key:u,childrenForm:v,kind:n,isFormDisabled:o,isOpen:i===u,isWhite:S%2===1,name:u,onOpenCategory:d,pathToData:[n,h]})))};sn.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const rn=sn,ln=(o,n,a)=>o.find(i=>i.action===n&&i.subject===a),cn=(o,n=[])=>o.reduce((a,i)=>(a[i.id]=n.indexOf(i.id)!==-1,a),{}),dn=({children:o},n,a="")=>o.reduce((i,l)=>{if(l.children)return{...i,[l.value]:dn(l,n,`${a}${l.value}.`)};const d=n.indexOf(`${a}${l.value}`)!==-1;return i[l.value]=d,i},{}),$n=(o,n,a)=>o.reduce((i,l)=>{const d=n.properties.find(({value:u})=>u===l);if(d){const u=(0,E.get)(a,["properties",d.value],[]),h=dn(d,u);i.properties[l]=h}return i},{properties:{}}),Un=(o,n)=>n.reduce((a,i)=>{const l=o.find(({uid:d})=>d===i)||null;return l&&(a[i]=l),a},{}),un=({subjects:o},n,a,i=[])=>n.reduce((l,d)=>{const u=d.subjects,h=Un(o,u);if((0,E.isEmpty)(h))return l;const v=Object.keys(h).reduce((S,A)=>{const{actionId:M,applyToProperties:I}=d,z=h[A].properties.map(({value:ie})=>ie).every(ie=>(I||[]).indexOf(ie)===-1),P=ln(i,M,A),B=cn(a,(0,E.get)(P,"conditions",[]));if((0,E.isEmpty)(I)||z)return(0,E.set)(S,[A,M],{properties:{enabled:P!==void 0},conditions:B}),S;const H=$n(I,h[A],P);return(0,E.set)(S,[A,M],{...H,conditions:B}),S},{});return(0,E.merge)(l,v)},{}),zn=(o,n,a)=>o.reduce((i,l)=>{const d=ln(a,l.action,null);return i[l.action]={properties:{enabled:d!==void 0},conditions:cn(n,(0,E.get)(d,"conditions",[]))},i},{}),Wn=(o,n,a)=>o.reduce((i,l)=>(i[l.subCategoryId]=zn(l.actions,n,a),i),{}),mn=(o,n,a=[])=>o.reduce((i,{categoryId:l,childrenForm:d})=>{const u=Wn(d,n,a);return i[l]=u,i},{}),pn=o=>o.split(" ").join("-"),gn=(o,n)=>Object.entries(w()(o,n)).map(([a,i])=>({category:a,categoryId:pn(a),childrenForm:Object.entries(w()(i,"subCategory")).map(([l,d])=>({subCategoryName:l,subCategoryId:pn(l),actions:d}))})),Zn=(o,n)=>{const{conditions:a,sections:{collectionTypes:i,singleTypes:l,plugins:d,settings:u}}=o,h={collectionTypes:i,singleTypes:l,plugins:gn(d,"plugin"),settings:gn(u,"category")},v={collectionTypes:un(i,i.actions||[],a,n),singleTypes:un(l,l.actions||[],a,n),plugins:mn(h.plugins,a,n),settings:mn(h.settings,a,n)};return{initialData:v,modifiedData:v,layouts:h}},hn=o=>Object.keys(o).reduce((n,a)=>{const i=o[a];if((0,E.isObject)(i)&&!(0,E.has)(i,"conditions"))return{...n,[a]:hn(i)};if((0,E.isObject)(i)&&(0,E.has)(i,"conditions")&&!Qe((0,E.omit)(i,"conditions")).some(d=>d)){const d=Object.keys(i.conditions).reduce((u,h)=>(u[h]=!1,u),{});return{...n,[a]:{...i,conditions:d}}}return n[a]=i,n},{}),Ht=hn,fn=(o,n)=>Object.keys(o).reduce((a,i)=>{const l=o[i];return i==="conditions"?(a[i]=l,a):(0,E.isObject)(l)?{...a,[i]:fn(l,n)}:(a[i]=n,a)},{}),Tt=fn,Gn={initialData:{},modifiedData:{},layouts:{}},Vn=(o,n)=>(0,he.default)(o,a=>{switch(n.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:i,actionId:l,value:d}=n,u=["modifiedData",i];Object.keys((0,E.get)(o,u)).forEach(h=>{const v=(0,E.get)(o,[...u,h,l],void 0);if(v){let S=Tt(v,d);if(!d&&S.conditions){const A=Tt(S.conditions,!1);S={...S,conditions:A}}(0,E.set)(a,[...u,h,l],S)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:i,propertyName:l,rowName:d,value:u}=n;let h=(0,E.cloneDeep)(o.modifiedData);const v=i.split(".."),S=(0,E.get)(h,v,{});Object.keys(S).forEach(A=>{if((0,E.has)(S[A],`properties.${l}`)){const M=(0,E.get)(S,[A,"properties",l,d]),I=[...v,A,"properties",l,d];if(!(0,E.isObject)(M))(0,E.set)(h,I,u);else{const U=Tt(M,u);(0,E.set)(h,I,U)}}}),u||(h=Ht(h)),(0,E.set)(a,"modifiedData",h);break}case"ON_CHANGE_CONDITIONS":{Object.entries(n.conditions).forEach(i=>{const[l,d]=i;(0,E.set)(a,["modifiedData",...l.split(".."),"conditions"],d)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let i=(0,E.cloneDeep)(o.modifiedData);(0,E.set)(i,[...n.keys.split("..")],n.value),n.value||(i=Ht(i)),(0,E.set)(a,"modifiedData",i);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:i,value:l}=n,d=[...i.split("..")];let u=(0,E.cloneDeep)(o.modifiedData);const h=(0,E.get)(u,d,{}),v=Tt(h,l);(0,E.set)(u,d,v),l||(u=Ht(u)),(0,E.set)(a,["modifiedData"],u);break}case"RESET_FORM":{a.modifiedData=o.initialData;break}case"SET_FORM_AFTER_SUBMIT":{a.initialData=o.modifiedData;break}default:return a}}),Kt=o=>Object.entries(o).filter(([,n])=>n).map(([n])=>n),Hn=o=>{const[n,{conditions:a}]=o;return{action:n,subject:null,conditions:Kt(a),properties:{}}},Kn=o=>Object.values(o).reduce((n,a)=>{const i=Object.entries(a).reduce((l,d)=>{const[,{properties:{enabled:u}}]=d;if(!u)return l;const h=Hn(d);return l.push(h),l},[]);return[...n,...i]},[]),yn=o=>Object.values(o).reduce((n,a)=>{const i=Kn(a);return[...n,...i]},[]),Cn=(o,n="")=>Object.entries(o).reduce((a,i)=>{const[l,d]=i;return(0,E.isObject)(d)?[...a,...Cn(d,`${n}${l}.`)]:(d&&!(0,E.isObject)(d)&&a.push(`${n}${l}`),a)},[]),Xn=(o,n,{conditions:a,properties:i})=>Object.entries(i).reduce((l,d)=>{const[u,h]=d;return l.properties[u]=Cn(h),l},{action:o,subject:n,conditions:Kt(a),properties:{}}),Yn=(o,n,{conditions:a})=>({action:o,subject:n,properties:{},conditions:Kt(a)}),Qn=(o,n)=>Object.entries(n).reduce((i,l)=>{const[d,u]=l;if(!Qe(u).some(S=>S))return i;if(!(0,E.has)(u,"properties.enabled")){const S=Xn(d,o,u);return[...i,S]}if(!u.properties.enabled)return i;const v=Yn(d,o,u);return i.push(v),i},[]),En=o=>Object.entries(o).reduce((a,i)=>{const[l,d]=i,u=Qn(l,d);return[...a,...u]},[]),Jn=o=>{const n=yn(o.plugins),a=yn(o.settings),i=En(o.collectionTypes),l=En(o.singleTypes);return[...n,...a,...i,...l]},qn=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}],Xt=(0,e.forwardRef)(({layout:o,isFormDisabled:n,permissions:a},i)=>{const[{initialData:l,layouts:d,modifiedData:u},h]=(0,e.useReducer)(Vn,Gn,()=>Zn(o,a)),{formatMessage:v}=(0,j.useIntl)();(0,e.useImperativeHandle)(i,()=>({getPermissions(){const O=(0,r.difference)(l.collectionTypes,u.collectionTypes),z=(0,r.difference)(l.singleTypes,u.singleTypes),P={...O,...z};let B;return ue()(P)?B=!1:B=Object.values(P).some(H=>Object.values(H).some(ie=>K()(ie,"conditions"))),{permissionsToSend:Jn(u),didUpdateConditions:B}},resetForm(){h({type:"RESET_FORM"})},setFormAfterSubmit(){h({type:"SET_FORM_AFTER_SUBMIT"})}}));const S=(O,z,P,B)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:O,propertyName:z,rowName:P,value:B})},A=(O,z,P)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:O,actionId:z,value:P})},M=O=>{h({type:"ON_CHANGE_CONDITIONS",conditions:O})},I=(0,e.useCallback)(({target:{name:O,value:z}})=>{h({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:O,value:z})},[]),U=(0,e.useCallback)(({target:{name:O,value:z}})=>{h({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:O,value:z})},[]);return e.createElement(On,{value:{availableConditions:o.conditions,modifiedData:u,onChangeConditions:M,onChangeSimpleCheckbox:I,onChangeParentCheckbox:U,onChangeCollectionTypeLeftActionRowCheckbox:S,onChangeCollectionTypeGlobalActionCheckbox:A}},e.createElement(c.TabGroup,{id:"tabs",label:v({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(c.Tabs,null,qn.map(O=>e.createElement(c.Tab,{key:O.id},v({id:O.labelId,defaultMessage:O.defaultMessage})))),e.createElement(c.TabPanels,{style:{position:"relative"}},e.createElement(c.TabPanel,null,e.createElement(nn,{layout:d.collectionTypes,kind:"collectionTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(nn,{layout:d.singleTypes,kind:"singleTypes",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(rn,{layout:d.plugins,kind:"plugins",isFormDisabled:n})),e.createElement(c.TabPanel,null,e.createElement(rn,{layout:d.settings,kind:"settings",isFormDisabled:n})))))});Xt.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},Xt.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const _n=(0,e.memo)(Xt)},34341:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!0},67500:(k,R,t)=>{"use strict";t.d(R,{Z:()=>e});const e=()=>"todo empty role"},52351:(k,R,t)=>{"use strict";t.d(R,{Z:()=>j});var e=t(67294),f=t(45697),s=t.n(f),r=t(28702),c=t.n(r),T=t(95489),K=t.n(T),Q=t(97132);const ue=({id:x,name:ke,description:C,usersCount:le,icons:ce,rowIndex:Ue})=>{const{formatMessage:ee}=(0,Q.useIntl)(),ze=ee({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:le});return e.createElement(r.Tr,{"aria-rowindex":Ue,key:x,...(0,T.onRowClick)({fn:ce[1].onClick})},e.createElement(r.Td,{maxWidth:(0,T.pxToRem)(130)},e.createElement(r.Typography,{ellipsis:!0,textColor:"neutral800"},ke)),e.createElement(r.Td,{maxWidth:(0,T.pxToRem)(250)},e.createElement(r.Typography,{ellipsis:!0,textColor:"neutral800"},C)),e.createElement(r.Td,null,e.createElement(r.Typography,{textColor:"neutral800"},ze)),e.createElement(r.Td,null,e.createElement(r.Flex,{justifyContent:"flex-end",...T.stopPropagation},ce.map((we,Ee)=>we?e.createElement(r.Box,{key:we.label,paddingLeft:Ee===0?0:1},e.createElement(r.IconButton,{onClick:we.onClick,label:we.label,noBorder:!0,icon:we.icon})):null))))};ue.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired,rowIndex:s().number.isRequired};const j=ue},85302:(k,R,t)=>{"use strict";t.d(R,{Z:()=>Pe});var e=t(67294),f=t(95489),s=t(87751),r=t(63852),c=t(41363),T=t(28702),K=t(97132),Q=t(49656),ue=t(52351),j=t(67500),x=t(45697),ke=t.n(x),C=t(27821),le=t(80994);const ce=t.p+"6d21938306785f176538.png",Ue=t.p+"617f9c948fa79e6d73bd.png",ee=C.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:D})=>(0,f.setHexOpacity)(D.colors.neutral800,.2)};
  padding: 0 ${({theme:D})=>D.spaces[8]};
`,ze=(0,C.default)(T.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,we=(0,C.default)(T.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,Ee=(0,C.default)(T.Box)`
  position: absolute;
  right: ${({theme:D})=>D.spaces[4]};
  top: ${({theme:D})=>D.spaces[4]};
`,We=({onClose:D,isOpen:N})=>{(0,f.useLockScroll)(N);const{formatMessage:q}=(0,K.useIntl)();return N?e.createElement(T.Portal,null,e.createElement(ee,{onClick:D},e.createElement(T.FocusTrap,{onEscape:D},e.createElement(ze,{onClick:Y=>Y.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:ce,alt:"air-balloon"}),e.createElement(Ee,null,e.createElement(T.IconButton,{onClick:D,"aria-label":"Close",icon:e.createElement(c.Cross,null)})),e.createElement(we,{spacing:6},e.createElement(T.Typography,{fontWeight:"bold",textColor:"primary600"},q({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(T.Stack,{spacing:2},e.createElement(T.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},q({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(T.Typography,null,q({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(le.Q,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(c.ExternalLink,null)},q({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:Ue,alt:"upgrade-arrow"}))))):null};We.propTypes={onClose:ke().func.isRequired,isOpen:ke().bool.isRequired};const Ze=We;var L=t(48474);const he=()=>{const{roles:D,isLoading:N}=(0,L.bF)(),q=(0,f.useQuery)(),Y=decodeURIComponent(q.get("_q")||""),ve=(0,r.ZP)(D,Y,{keys:["name","description"]});return{isLoading:N,sortedRoles:ve}},X=()=>{const{formatMessage:D}=(0,K.useIntl)(),[N,q]=(0,e.useState)(!1),{trackUsage:Y}=(0,f.useTracking)(),{push:ve}=(0,Q.useHistory)(),E=(0,e.useCallback)(ne=>{ve(`/settings/roles/${ne}`)},[ve]),xe=(0,e.useCallback)(()=>{q(ne=>!ne)},[]),Ie=(0,e.useCallback)(()=>{Y("didShowRBACUpgradeModal"),q(!0)},[Y]),Se=(0,e.useCallback)(ne=>[{onClick:xe,label:D({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(c.Duplicate,null)},{onClick:()=>E(ne.id),label:D({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(c.Pencil,null)},{onClick:xe,label:D({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(c.Trash,null)}],[D,xe,E]);return{isModalOpen:N,handleToggleModalForCreatingRole:Ie,handleToggle:xe,getIcons:Se}},be=()=>{const{formatMessage:D}=(0,K.useIntl)();(0,f.useFocusWhenNavigate)();const{sortedRoles:N,isLoading:q}=he(),{isModalOpen:Y,handleToggle:ve,handleToggleModalForCreatingRole:E,getIcons:xe}=X(),Ie=N.length+1,Se=5;return e.createElement(T.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(T.HeaderLayout,{primaryAction:e.createElement(T.Button,{onClick:E,startIcon:e.createElement(c.Plus,null),size:"S"},D({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:D({id:"global.roles",defaultMessage:"roles"}),subtitle:D({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(T.ContentLayout,null,e.createElement(T.Table,{colCount:Se,rowCount:Ie,footer:e.createElement(T.TFooter,{onClick:E,icon:e.createElement(c.Plus,null)},D({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(T.Thead,null,e.createElement(T.Tr,null,e.createElement(T.Th,null,e.createElement(T.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.name",defaultMessage:"Name"}))),e.createElement(T.Th,null,e.createElement(T.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.description",defaultMessage:"Description"}))),e.createElement(T.Th,null,e.createElement(T.Typography,{variant:"sigma",textColor:"neutral600"},D({id:"global.users",defaultMessage:"Users"}))),e.createElement(T.Th,null,e.createElement(T.VisuallyHidden,null,D({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(T.Tbody,null,N?.map((ne,me)=>e.createElement(ue.Z,{key:ne.id,id:ne.id,name:ne.name,description:ne.description,usersCount:ne.usersCount,icons:xe(ne),rowIndex:me+2})))),!Ie&&!q&&e.createElement(j.Z,null)),e.createElement(Ze,{isOpen:Y,onClose:ve}))},Pe=()=>e.createElement(f.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(be,null))},35301:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=[]},26789:(k,R,t)=>{"use strict";t.d(R,{Z:()=>Ze});var e=t(67294),f=t(47292),s=t(95489),r=t(28702),c=t(41363),T=t(80831),K=t(27361),Q=t.n(K),ue=t(41609),j=t.n(ue),x=t(97132),ke=t(49656),C=t(27821),le=t(28834),ce=t(48474),Ue=t(87751),ee=t(53209);const we=ee.Ry().shape({name:ee.Z_().required(s.translatedErrors.required),description:ee.Z_().required(s.translatedErrors.required)}),Ee=C.default.div`
  border: 1px solid ${({theme:L})=>L.colors.primary200};
  background: ${({theme:L})=>L.colors.primary100};
  padding: ${({theme:L})=>`${L.spaces[2]} ${L.spaces[4]}`};
  color: ${({theme:L})=>L.colors.primary600};
  border-radius: ${({theme:L})=>L.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,We=()=>{const L=(0,s.useNotification)(),{lockApp:he,unlockApp:X}=(0,s.useOverlayBlocker)(),{formatMessage:w}=(0,x.useIntl)(),[be,J]=(0,e.useState)(!1),{replace:Pe}=(0,ke.useHistory)(),D=(0,e.useRef)(),{trackUsage:N}=(0,s.useTracking)(),q=(0,ke.useRouteMatch)("/settings/roles/duplicate/:id"),Y=Q()(q,"params.id",null),{isLoading:ve,data:E}=(0,ce.U_)(),{permissions:xe,isLoading:Ie}=(0,ce.Dq)(Y),Se=me=>{he(),J(!0),N(Y?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,s.request)("/admin/roles",{method:"POST",body:me})).then(async W=>{const{permissionsToSend:oe}=D.current.getPermissions();return N(Y?"didDuplicateRole":"didCreateNewRole"),W.data.id&&!j()(oe)&&await(0,s.request)(`/admin/roles/${W.data.id}/permissions`,{method:"PUT",body:{permissions:oe}}),W}).then(W=>{J(!1),L({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Pe(`/settings/roles/${W.data.id}`)}).catch(W=>{console.error(W),J(!1),L({type:"warning",message:{id:"notification.error"}})}).finally(()=>{X()})},ne=`${w({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,f.format)(new Date,"PPP")}`;return e.createElement(r.Main,null,e.createElement(s.SettingsPageTitle,{name:"Roles"}),e.createElement(T.Formik,{initialValues:{name:"",description:ne},onSubmit:Se,validationSchema:we,validateOnChange:!1},({handleSubmit:me,values:W,errors:oe,handleReset:Ve,handleChange:Oe})=>e.createElement(s.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(r.HeaderLayout,{primaryAction:e.createElement(r.Stack,{horizontal:!0,spacing:2},e.createElement(r.Button,{variant:"secondary",onClick:()=>{Ve(),D.current.resetForm()},size:"L"},w({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(r.Button,{onClick:me,loading:be,size:"L"},w({id:"global.save",defaultMessage:"Save"}))),title:w({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:w({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(s.Link,{startIcon:e.createElement(c.ArrowLeft,null),to:"/settings/roles"},w({id:"global.back",defaultMessage:"Back"}))}),e.createElement(r.ContentLayout,null,e.createElement(r.Stack,{spacing:6},e.createElement(r.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(r.Stack,{spacing:4},e.createElement(r.Flex,{justifyContent:"space-between"},e.createElement(r.Box,null,e.createElement(r.Box,null,e.createElement(r.Typography,{fontWeight:"bold"},w({id:"global.details",defaultMessage:"Details"}))),e.createElement(r.Box,null,e.createElement(r.Typography,{variant:"pi",textColor:"neutral600"},w({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(Ee,null,w({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(r.Grid,{gap:4},e.createElement(r.GridItem,{col:6},e.createElement(r.TextInput,{name:"name",error:oe.name&&w({id:oe.name}),label:w({id:"global.name",defaultMessage:"Name"}),onChange:Oe,value:W.name})),e.createElement(r.GridItem,{col:6},e.createElement(r.Textarea,{label:w({id:"global.description",defaultMessage:"Description"}),name:"description",error:oe.description&&w({id:oe.description}),onChange:Oe},W.description))))),!ve&&!Ie?e.createElement(r.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(le.Z,{isFormDisabled:!1,ref:D,permissions:xe,layout:E})):e.createElement(r.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(s.LoadingIndicatorPage,null))))))))};function Ze(){return e.createElement(s.CheckPagePermissions,{permissions:Ue.Z.settings.roles.create},e.createElement(We,null))}},53273:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},20591:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},74512:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},76766:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},85822:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},8629:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const f=!1},64527:(k,R,t)=>{"use strict";t.d(R,{Z:()=>Ze});var e=t(67294),f=t(95489),s=t(87751),r=t(41363),c=t(28702),T=t(96486),K=t(63852),Q=t(97132),ue=t(49656),j=t(48474),x=t(67500),ke=t(52351),C=t(18172);const le={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},Ue=(L,he)=>(0,C.default)(L,X=>{switch(he.type){case"ON_REMOVE_ROLES":{X.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{X.shouldRefetchData=!0,X.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{X.shouldRefetchData=!1,X.roleToDelete=null,X.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{X.roleToDelete=he.id;break}default:return X}}),ee=()=>{(0,f.useFocusWhenNavigate)();const{isLoading:L,allowedActions:{canCreate:he,canDelete:X,canRead:w,canUpdate:be}}=(0,f.useRBAC)(s.Z.settings.roles),{getData:J,roles:Pe,isLoading:D}=(0,j.bF)(!1),[{query:N}]=(0,f.useQueryParams)(),q=N?._q||"",Y=(0,K.ZP)(Pe,q,{keys:["name","description"]});return(0,e.useEffect)(()=>{!L&&w&&J()},[L,w,J]),{isLoadingForPermissions:L,canCreate:he,canDelete:X,canRead:w,canUpdate:be,isLoading:D,getData:J,sortedRoles:Y,roles:Pe}},ze=({getData:L,canCreate:he,canDelete:X,canUpdate:w})=>{const{formatMessage:be}=(0,Q.useIntl)(),J=(0,f.useNotification)(),[Pe,D]=(0,e.useState)(!1),{push:N}=(0,ue.useHistory)(),[{selectedRoles:q,showModalConfirmButtonLoading:Y,roleToDelete:ve},E]=(0,e.useReducer)(Ue,le),{post:xe}=(0,f.getFetchClient)(),Ie=async()=>{try{E({type:"ON_REMOVE_ROLES"}),await xe("/admin/roles/batch-delete",{ids:[ve]}),await L(),E({type:"RESET_DATA_TO_DELETE"})}catch(_){const Me=(0,T.get)(_,["response","payload","data","ids"],null);if(Me&&Array.isArray(Me)){const Ye=Me.join(`
`);J({type:"warning",message:Ye})}else J({type:"warning",message:{id:"notification.error"}})}W()},Se=(0,e.useCallback)(_=>{N(`/settings/roles/duplicate/${_}`)},[N]),ne=()=>N("/settings/roles/new"),me=(0,e.useCallback)(_=>{E({type:"SET_ROLE_TO_DELETE",id:_}),W()},[]),W=()=>D(_=>!_),oe=(0,e.useCallback)(_=>{N(`/settings/roles/${_}`)},[N]),Ve=(0,e.useCallback)((_,Me)=>{_.preventDefault(),_.stopPropagation(),Me.usersCount?J({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):me(Me.id)},[J,me]),Oe=(0,e.useCallback)((_,Me)=>{_.preventDefault(),_.stopPropagation(),Se(Me.id)},[Se]),At=(0,e.useCallback)(_=>[...he?[{onClick:Me=>Oe(Me,_),label:be({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(r.Duplicate,null)}]:[],...w?[{onClick:()=>oe(_.id),label:be({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(r.Pencil,null)}]:[],...X?[{onClick:Me=>Ve(Me,_),label:be({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(r.Trash,null)}]:[]],[be,Ve,Oe,oe,he,w,X]);return{handleNewRoleClick:ne,getIcons:At,selectedRoles:q,isWarningDeleteAllOpened:Pe,showModalConfirmButtonLoading:Y,handleToggleModal:W,handleDeleteData:Ie}},Ee=()=>{const{formatMessage:L}=(0,Q.useIntl)(),{isLoadingForPermissions:he,canCreate:X,canRead:w,canDelete:be,canUpdate:J,isLoading:Pe,getData:D,sortedRoles:N}=ee(),{handleNewRoleClick:q,getIcons:Y,isWarningDeleteAllOpened:ve,showModalConfirmButtonLoading:E,handleToggleModal:xe,handleDeleteData:Ie}=ze({getData:D,canCreate:X,canDelete:be,canUpdate:J}),Se=N.length+1,ne=6;if(he)return e.createElement(c.Main,null,e.createElement(f.LoadingIndicatorPage,null));const me=L({id:"global.roles",defaultMessage:"roles"});return e.createElement(c.Main,null,e.createElement(f.SettingsPageTitle,{name:"Roles"}),e.createElement(c.HeaderLayout,{primaryAction:X?e.createElement(c.Button,{onClick:q,startIcon:e.createElement(r.Plus,null),size:"S"},L({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:me,subtitle:L({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),w&&e.createElement(c.ActionLayout,{startActions:e.createElement(f.SearchURLQuery,{label:L({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:me})})}),w&&e.createElement(c.ContentLayout,null,e.createElement(c.Table,{colCount:ne,rowCount:Se,footer:X?e.createElement(c.TFooter,{onClick:q,icon:e.createElement(r.Plus,null)},L({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(c.Thead,null,e.createElement(c.Tr,{"aria-rowindex":1},e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},L({id:"global.name",defaultMessage:"Name"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},L({id:"global.description",defaultMessage:"Description"}))),e.createElement(c.Th,null,e.createElement(c.Typography,{variant:"sigma",textColor:"neutral600"},L({id:"global.users",defaultMessage:"Users"}))),e.createElement(c.Th,null,e.createElement(c.VisuallyHidden,null,L({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(c.Tbody,null,N?.map((W,oe)=>e.createElement(ke.Z,{key:W.id,id:W.id,name:W.name,description:W.description,usersCount:W.usersCount,icons:Y(W),rowIndex:oe+2})))),!Se&&!Pe&&e.createElement(x.Z,null)),e.createElement(f.ConfirmDialog,{isOpen:ve,onConfirm:Ie,isConfirmButtonLoading:E,onToggleDialog:xe}))},Ze=()=>e.createElement(f.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(Ee,null))},5420:(k,R,t)=>{"use strict";t.d(R,{Z:()=>f});const e=[];strapi.features.isEnabled(strapi.features.SSO)&&e.push({async Component(){return await t.e(302).then(t.bind(t,40316))},to:"/settings/single-sign-on",exact:!0}),strapi.features.isEnabled(strapi.features.AUDIT_LOGS)&&e.push({async Component(){return await t.e(2812).then(t.bind(t,35915))},to:"/settings/audit-logs",exact:!0});const f=e},44174:k=>{function R(t,e,f,s){for(var r=-1,c=t==null?0:t.length;++r<c;){var T=t[r];e(s,T,f(T),t)}return s}k.exports=R},81119:(k,R,t)=>{var e=t(89881);function f(s,r,c,T){return e(s,function(K,Q,ue){r(T,K,c(K),ue)}),T}k.exports=f},55189:(k,R,t)=>{var e=t(44174),f=t(81119),s=t(67206),r=t(1469);function c(T,K){return function(Q,ue){var j=r(Q)?e:f,x=K?K():{};return j(Q,T,s(ue,2),x)}}k.exports=c},94654:(k,R,t)=>{var e=t(21078),f=t(35161);function s(r,c){return e(f(r,c),1)}k.exports=s},7739:(k,R,t)=>{var e=t(89465),f=t(55189),s=Object.prototype,r=s.hasOwnProperty,c=f(function(T,K,Q){r.call(T,Q)?T[Q].push(K):e(T,Q,[K])});k.exports=c},35161:(k,R,t)=>{var e=t(29932),f=t(67206),s=t(69199),r=t(1469);function c(T,K){var Q=r(T)?e:s;return Q(T,f(K,3))}k.exports=c}}]);
